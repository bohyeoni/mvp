# 🤖 RAG 기반 광고분석 쿼리 어시스턴트

> 자연어로 정의서를 찾지 않고도 광고 데이터 분석을 위한 SQL을 생성하는 지능형 어시스턴트

## 📌 프로젝트 개요

- **서비스명:** RAG 기반 광고분석 쿼리 어시스턴트
- **작성일:** 2025년 7월 16일
- **작성자:** 강보현
- **버전:** v1.0

---

## 🎯 서비스 목적

지니TV의 광고 시청, VOD 시청, 채널 시청 내역 등 방대한 로그 데이터를 바탕으로 분석 업무를 수행하는 사용자들이,  
**SQL을 몰라도**, **정의서를 뒤적이지 않아도**, 자연어로 원하는 데이터를 쉽게 추출할 수 있도록 지원하는 AI 기반 쿼리 어시스턴트를 개발한다.

---

## 🧠 문제 정의

| 문제 | 상세 내용 |
|------|-----------|
| SQL 작성 어려움 | 광고영업사, 광고사업팀 등 비개발자는 SQL 작성이 어려움 |
| 정의서 접근 불편 | 테이블명, 컬럼명을 알기 위해 수동 정의서 검색 혹은 운영자 문의 필요 |
| 반복적 커뮤니케이션 | 쿼리 요청-수정 반복으로 업무 병목 발생 |
| 구조 정보의 단절 | LLM은 내부 데이터 구조를 알 수 없어 쿼리 정확도 낮음 |

---

## 🔍 사용자 시나리오 예시

- `"25년 6월 한 달간 채널광고 시청내역을 조회할 수 있는 쿼리를 만들어줘"`
- `"일자별 채널별 셋탑 수를 추출할 수 있는 테이블을 알려줘"`
- `"채널시청횟수는 컬럼명이 뭐야?"`

---

## 🧩 주요 기능

| 기능 | 설명 |
|------|------|
| 자연어 → SQL 쿼리 생성 | 사용자 요청을 이해하고 SQL 생성 |
| 테이블/컬럼 탐색 응답 | 정의서 없이도 메타데이터 기반 정보 제공 |
| 컬럼명 검색 | 사용자 질의에 맞는 컬럼명 추천 |
| 사용자 맥락 유지 (선택) | 이전 질의 히스토리 기반 쿼리 보완 응답 |

---

## 🔧 기술 아키텍처

### 🛠 기술 스택 (예상 안)

| 구성 | 기술 |
|------|------|
| 자연어 처리 | GPT-4o-mini / Azure OpenAI |
| 검색 엔진 | RAG (FAISS, Chroma, Weaviate 등) |
| 애플리케이션 프레임워크 | LangChain, FastAPI |
| 프론트엔드 | Streamlit |
| 데이터 소스 | Azure SQL, Blob Storage |
| 메타데이터 저장소 | JSON, PostgreSQL, CosmosDB 등

---

## 🧱 시스템 구성도

```plaintext
[ 사용자 ]
     │
     ▼
[ 프론트엔드 UI ]
     │
     ▼
[ LangChain Agent ]
     │
     ├─> RAG Retriever: 정의서 기반 메타데이터 검색
     └─> LLM + Prompt: SQL 생성
           │
           ▼
     결과 반환 또는 쿼리 실행
````

---

## 🗂 메타데이터 예시

|엔티티명|테이블명|속성명|칼럼명|자료형|
|tv_채널광고노출이력|in_otv_cntpnt_advr_log_hist|기준일자|base_date|string|
|tv_채널광고노출이력|in_otv_cntpnt_advr_log_hist|광고편성ID|frmtn_id|string|
|tv_채널광고노출이력|in_otv_cntpnt_advr_log_hist|시작일시|strt_dt|string|
|tv_채널광고노출이력|in_otv_cntpnt_advr_log_hist|시청비율|plyb_rati|int|
...

* 엑셀 형태의 속성 정의서를 기반으로 사용
* json 형태로 변환하여 업로드 등 방안 검토 예정

---

## 💡 기대 효과

* SQL 몰라도 광고 분석 데이터 활용 가능
* 운영자 업무 부하 감소 (정의서 문의 제거)
* 반복 쿼리 생성 자동화 → 분석 속도 향상
* 정확한 컬럼/테이블 매핑으로 쿼리 품질 보장

---

## 📝 향후 확장 방향

* 쿼리 결과 자동 시각화 (Graph + Table)
* Power BI, Looker 등 BI 도구와 연동
* 사용자 맞춤형 질의 히스토리 분석
* 사전 등록된 쿼리 템플릿 추천 기능

```
