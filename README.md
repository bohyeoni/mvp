# 🤖 광고분석 쿼리 어시스턴트 시스템 제안서 (RAG 기반)

## 📌 프로젝트 개요

- **프로젝트명:** 광고분석 쿼리 어시스턴트 (AI SQL Helper)
- **작성일:** 2025년 7월 16일
- **작성자:** AIDX EDU
- **버전:** v1.1

---

## 🎯 목적

광고, VOD, 채널 시청 데이터 등 방대한 로그 기반의 분석 시스템 환경에서 SQL 작성 능력이 없는 사용자도 **자연어로 데이터 요청이 가능하도록** 돕는 AI 기반 어시스턴트 시스템을 구축한다.

또한, 사용자가 복잡한 정의서를 참조하거나 운영자에게 반복적으로 질문하는 수고를 줄이고, 메타데이터 기반 지능형 질의 응답을 통해 **데이터 접근성과 분석 생산성을 동시에 향상**시키는 것이 목표다.

---

## 🧠 문제 정의

| 문제 | 상세 내용 |
|------|-----------|
| SQL 작성 어려움 | 일반 사용자(기획자, 마케터)는 SQL 문법에 익숙하지 않아 직접 데이터 추출이 어려움 |
| 테이블/컬럼 파악 어려움 | 정의서를 수동으로 열람하거나 운영자에게 직접 물어봐야 정보를 얻을 수 있음 |
| 비효율적인 커뮤니케이션 | 데이터 요청 → 검토 → 운영자 피드백 반복, 분석 속도 지연 발생 |
| 메타데이터 단절 | LLM이 데이터 구조를 모르므로 쿼리 생성의 정확도가 낮음 |

---

## 🧩 시스템 기능 요약

### 🔍 사용자 자연어 질의 예시

- `"25년 6월 한달간 채널광고 시청내역을 조회할 수 있는 쿼리를 만들어줘"`
- `"일자별 채널별 셋탑 수를 추출할 수 있는 테이블을 알려줘"`
- `"채널시청횟수는 컬럼명이 뭐야?"`

### ✨ 제공 기능

| 기능 | 설명 |
|------|------|
| 자연어 → SQL 쿼리 생성 | 사용자의 요청을 이해하고 실제 쿼리를 자동 생성 |
| 테이블 및 컬럼 탐색 | 조건에 맞는 테이블명, 컬럼명, 정의 정보 제공 |
| 정의서 없이 메타데이터 응답 | 문서 없이도 질문하면 구조 정보 기반으로 답변 가능 |
| 사용 이력 기반 추천 (선택) | 이전 쿼리 히스토리를 반영해 유사 요청 자동화 가능 |

---

## 🔧 기술 아키텍처

### 🛠 주요 기술 스택

| 구성 요소 | 기술 |
|-----------|------|
| 자연어 처리 | OpenAI GPT-4 / Azure OpenAI |
| 검색 인프라 | RAG (Retrieval-Augmented Generation), FAISS / Weaviate |
| 프레임워크 | LangChain, FastAPI |
| 프론트엔드 | React + TailwindCSS (웹 기반 UI) |
| 데이터 소스 | Azure SQL, Azure Blob Storage |
| 메타데이터 저장 | JSON / CosmosDB / PostgreSQL 등 |

---

## 🧱 시스템 구성도

```plaintext
[ 사용자 ]
     │
     ▼
[ 프론트엔드 ] — 자연어 입력
     │
     ▼
[ LangChain Agent ]
     │
     ├─> RAG Retriever: 정의서, 테이블 목록, 컬럼명 검색
     │
     └─> LLM Prompt + 메타데이터로 SQL 생성
           │
           ▼
     SQL 결과 반환 또는 실행 쿼리 출력
````

> 🔎 RAG는 사용자의 질문을 벡터화하여, 메타데이터에서 가장 유사한 정보를 찾아 LLM이 참고하게 합니다.
> 📘 정의서 문서를 LLM이 직접 참조하지 않고, 요약된 메타DB에 기반하여 빠르게 답변합니다.

---

## 🗂 메타데이터 구성 예시

```json
[
  {
    "table_name": "channel_ad_watch_log",
    "columns": [
      { "name": "WATCH_DATE", "description": "시청 일자" },
      { "name": "CHANNEL_ID", "description": "채널 식별자" },
      { "name": "VIEW_CNT", "description": "시청 횟수" }
    ]
  }
]
```

* 메타데이터는 Azure에 JSON, CSV, 혹은 DB 형태로 등록
* 컬럼명 생성 규칙 등도 함께 등록하여 규칙 기반 응답 보완

---

## ⏱️ 개발 일정

| 단계          | 기간                  | 주요 내용                   |
| ----------- | ------------------- | ----------------------- |
| 요구사항 정리     | 2025.07.15 \~ 07.31 | 시나리오 수집, 정의서 정리         |
| PoC 개발      | 2025.08.01 \~ 08.20 | RAG 기반 질의 응답, 쿼리 템플릿 구현 |
| 메타데이터 통합    | 2025.08.21 \~ 09.05 | 실제 테이블 정의 연동            |
| UI 개발 및 고도화 | 2025.09.06 \~ 09.25 | 프론트 + 세션 관리 기능 개발       |
| 테스트 및 배포    | 2025.09.26 이후       | QA 및 Azure 환경 배포        |

---

## 💡 기대 효과

* **비SQL 사용자도 데이터 분석 가능**
* **운영자 의존 없이 분석 자율성 확보**
* **광고/시청 로그 데이터 접근성 향상**
* **데이터 정의서 관리 자동화 기반 확보**

---

## 📝 향후 확장 방향

* **쿼리 실행 시뮬레이터 내장**: 실행 결과 미리보기
* **BI 도구 연동**: Power BI, Looker 등에 쿼리 연동
* **자동 쿼리 저장소 생성**: 자주 쓰는 쿼리 공유

---

## 📎 참고 자료

* LangChain: [https://www.langchain.com/](https://www.langchain.com/)
* OpenAI API: [https://platform.openai.com/docs](https://platform.openai.com/docs)
* FAISS (벡터 검색): [https://github.com/facebookresearch/faiss](https://github.com/facebookresearch/faiss)
* Azure SQL & Storage: [https://azure.microsoft.com/](https://azure.microsoft.com/)

```
